function getDonationForms(){return window.donationForms||{}}var vpfEmployerList=["Adobe","AMD","Applied Materials","Atlassian","Broadcom","ByteDance","Cadence","Cadence Design Systems","Cisco","Cisco Systems","Cloudera","Coupa Software","Dell","DIRECTV","DocuSign","Electronic Arts","Esurance","Etsy","Genworth","Genworth Financial","Hewlett Packard Enterprise Foundation","HPI","IBM","Intel","Intuitive Foundation","Juniper","Lam Research","LexisNexis","LinkedIn","McAfee","Microsoft","Morgan Stanley","NetApp","Oracle","Palo Alto Networks","PayPal","Pfizer","PlayStation Cares","Pure Storage","Qualcomm","Roblox","Samsung","SAP","Solidigm","Splunk","Symantec","UHG","Unum","Veeva","Veritas","VISA","Wells Fargo","Yahoo"],matchingSupportedList=["Apple","Autodesk","BlackRock","Ciena","Delta Dental","Dropbox","eBay","Equinix","F5","FalconX","Gilead","Google","Indeed","Intuit","Kaiser","Keysight","KLA","McKesson","Medtronic","Netflix","NVIDIA","Okta","Salesforce","ServiceNow","Synopsys","T-Mobile","TE Connectivity","The Illumina Foundation","Illumina","Workday"],currentUrlType="ihf";function setEmployerCookie(e){var t=encodeURIComponent(e),n="max-age=31536000",o="path=/";document.cookie="ihf_employer_name="+t+"; "+o+"; domain=.kbmandir.org; "+n,document.cookie="ihf_employer_name="+t+"; "+o+"; domain=.kbgoshala.org; "+n,document.cookie="ihf_employer_name="+t+"; "+o+"; "+n}function getEmployerCookie(){var e=document.cookie.match(/(?:^|; )ihf_employer_name=([^;]*)/);return e?decodeURIComponent(e[1]):null}function getStoredEmployer(){return getEmployerCookie()||localStorage.getItem("ihf_employer_name")||""}function isVpfMatch(e){if(!e)return!1;var t=e.toLowerCase();return vpfEmployerList.some(function(e){return t.includes(e.toLowerCase())})}function isMatchingSupported(e){if(!e)return!1;var t=e.toLowerCase();return matchingSupportedList.some(function(e){return t.includes(e.toLowerCase())})}function getMatchTier(e){return e&&e.trim()?isVpfMatch(e)?"vpf":isMatchingSupported(e)?"matching":"none":"none"}function getUrlTypeForEmployer(e){return"vpf"===getMatchTier(e)?"vpf":"ihf"}function showBanner(e){var t=document.getElementById("employerBanner"),n=document.getElementById("bannerEmployerName"),o=document.getElementById("matchingBadge");n.textContent=e;var r=getMatchTier(e);"vpf"===r?(o.textContent="Matching eligible",o.className="matching-badge vpf"):"matching"===r?(o.textContent="Employer supports matching",o.className="matching-badge matching-supported"):(o.textContent="",o.className="matching-badge no-match"),t.classList.add("visible")}function hideBanner(){document.getElementById("employerBanner").classList.remove("visible")}function showEmployerModal(){var e=document.getElementById("employerBanner"),t=document.getElementById("bannerEditRow");t&&t.remove(),(t=document.createElement("div")).id="bannerEditRow",t.className="banner-edit-row",t.innerHTML='<input type="text" placeholder="Employer name" value="'+(getStoredEmployer()||"")+'" /><button type="button">Apply</button>';var n=t.querySelector("input"),o=t.querySelector("button");o.addEventListener("click",function(){var e=n.value.trim();e?(setEmployerCookie(e),localStorage.setItem("ihf_employer_name",e),currentUrlType=getUrlTypeForEmployer(e),showBanner(e),t.remove(),renderTiles(currentUrlType)):n.focus()}),n.addEventListener("keydown",function(e){"Enter"===e.key&&o.click()}),e.appendChild(t),attachAutocomplete(n),setTimeout(function(){n.focus()},100)}var activeInlineInput=null,navigating=!1;function showLoading(e){if(navigating)return!1;navigating=!0,e&&(e.style.opacity="0.6",e.style.pointerEvents="none");var t=e&&e.querySelector(".tile-cta");return t&&(t.textContent="Loading..."),!0}function showInlineEmployerInput(e,t,n){activeInlineInput&&activeInlineInput.remove();var o=document.createElement("div");o.className="tile-inline-employer",o.innerHTML='<p class="tile-inline-title">Double your donation!</p><p class="tile-inline-subtitle">Enter your employer name to check if your gift can be matched.</p><div class="tile-inline-input-row"><input type="text" placeholder="Employer name" /><button type="button">Apply</button><button type="button" class="tile-inline-skip-btn">Not applicable</button></div>';var r=o.querySelector("input"),i=o.querySelector("button"),a=o.querySelector(".tile-inline-skip-btn");function l(){var o=r.value.trim();o?showLoading(e)&&(setEmployerCookie(o),localStorage.setItem("ihf_employer_name",o),currentUrlType=getUrlTypeForEmployer(o),(window.top||window).location.href=t[currentUrlType]+n):r.focus()}i.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),l()}),a.addEventListener("click",function(o){o.preventDefault(),o.stopPropagation(),showLoading(e)&&(setEmployerCookie("NA"),localStorage.setItem("ihf_employer_name","NA"),(window.top||window).location.href=t.ihf+n)}),r.addEventListener("keydown",function(e){"Enter"===e.key&&(e.preventDefault(),l())}),r.addEventListener("click",function(e){e.stopPropagation()}),o.addEventListener("click",function(e){e.stopPropagation()}),e.appendChild(o),activeInlineInput=o,attachAutocomplete(r),setTimeout(function(){r.focus()},100)}function buildCard(e,t,n,o){var r=document.createElement("a");r.href=e[t]+n,r.target="_top",r.className="tile",r.addEventListener("click",function(t){var o=getStoredEmployer();if(o&&o.trim())return showLoading(r)?void(r.href=e[currentUrlType]+n):void t.preventDefault();t.preventDefault(),showInlineEmployerInput(r,e,n)});var i=document.createElement("div");i.className="tile-image-wrap";var a=document.createElement("div");a.className="image-placeholder",a.style.backgroundColor=e.bgColor||"#e0e0e0",a.innerHTML='<div class="placeholder-content"><div class="placeholder-icon">'+(e.icon||"üôè")+'</div><div class="placeholder-text">'+e.label+"</div></div>";var l,c,d=document.createElement("img");d.src=e.img,d.alt=e.label,d.loading=o?"eager":"lazy",d.decoding="async",d.sizes=o?"(max-width: 720px) 100vw, 720px":"(max-width: 560px) 100vw, (max-width: 900px) 50vw, 33vw",o&&(d.fetchPriority="high"),d.style.opacity="0",c=a,(l=d).onload=function(){l.style.opacity="1",c.style.opacity="0",setTimeout(function(){c.remove()},300)},l.onerror=function(){c.classList.add("error")};var s=document.createElement("div");s.className="gradient-overlay";var p=document.createElement("div");if(p.className="tile-title-overlay",p.innerHTML='<span class="tile-title-text">'+e.label+"</span>",e.price){var m=document.createElement("span");m.className="tile-price-badge",m.textContent=e.price,i.appendChild(m)}i.appendChild(a),i.appendChild(d),i.appendChild(s),i.appendChild(p);var u=document.createElement("div");u.className="tile-body";var g=document.createElement("p");g.className="tile-tagline",g.textContent=e.tagline||"";var f=document.createElement("p");f.className="tile-description",f.textContent=e.description||"";var h=document.createElement("span");return h.className="tile-cta",h.textContent="Donate now",u.appendChild(g),u.appendChild(f),u.appendChild(h),r.appendChild(i),r.appendChild(u),r}function renderTiles(e){var t=document.getElementById("heroTile"),n=document.getElementById("donationTiles");t&&(t.innerHTML=""),n&&(n.innerHTML="");var o=new URLSearchParams(window.location.search),r=o.get("opportunity")||o.get("form");o.delete("form"),o.delete("opportunity"),o.delete("seva"),o.delete("auto"),o.delete("c");var i=o.toString()?"?"+o.toString():"",a=Object.entries(getDonationForms());if(r){var l=a.slice();a.sort(function(e,t){return e[0]===r?-1:t[0]===r?1:l.findIndex(function(t){return t[0]===e[0]})-l.findIndex(function(e){return e[0]===t[0]})})}a.length>0&&t&&t.appendChild(buildCard(a[0][1],e,i,!0));for(var c=t?1:0;c<a.length;c++)n.appendChild(buildCard(a[c][1],e,i,!1))}var prefetchedImages={};function prefetchHeroImage(){var e=Object.entries(getDonationForms());if(0!==e.length){var t=e[0][1];if(!prefetchedImages[t.img]){var n=new Image;n.src=t.img,n.fetchPriority="high",prefetchedImages[t.img]=!0}}}function prefetchRemainingImages(){for(var e=Object.entries(getDonationForms()),t=1;t<e.length;t++){var n=e[t][1];if(!prefetchedImages[n.img])(new Image).src=n.img,prefetchedImages[n.img]=!0}}function prefetchFormUrls(){for(var e=Object.entries(getDonationForms()),t=0;t<e.length;t++){var n=e[t][1];["vpf","ihf"].forEach(function(e){var t=document.createElement("link");t.rel="prefetch",t.href=n[e],document.head.appendChild(t)})}}var employerSuggestions=function(){var e=vpfEmployerList.concat(matchingSupportedList).filter(function(e,t,n){return n.indexOf(e)===t}),t=e.filter(function(t){var n=t.toLowerCase();return!e.some(function(e){var t=e.toLowerCase();return t!==n&&t.length<n.length&&-1!==n.indexOf(t)})});return t.sort(function(e,t){return e.localeCompare(t)}),t}(),isMobile=window.matchMedia("(max-width: 768px)").matches;function attachAutocomplete(e){if(!isMobile){var t="dl_"+Math.random().toString(36).substr(2,6),n=document.createElement("datalist");n.id=t,e.setAttribute("list",t),e.setAttribute("autocomplete","off"),e.parentNode.appendChild(n),e.addEventListener("input",function(){n.innerHTML="";var t=e.value.trim();if(!(t.length<2)){var o=t.toLowerCase();employerSuggestions.some(function(e){return e.toLowerCase()===o})||employerSuggestions.forEach(function(e){if(-1!==e.toLowerCase().indexOf(o)){var t=document.createElement("option");t.value=e,n.appendChild(t)}})}})}}!function(){function e(){var e=document.getElementById("donationPageWrap");e&&(e.style.opacity="1")}try{prefetchHeroImage();var t=new URLSearchParams(window.location.search),n=t.get("c");if(n&&n.trim()){var o=getStoredEmployer();o&&o.trim()||(setEmployerCookie(n.trim()),localStorage.setItem("ihf_employer_name",n.trim()))}var r=getStoredEmployer();if(r&&r.trim()){currentUrlType=getUrlTypeForEmployer(r);var i=t.get("seva")||t.get("opportunity")||t.get("form"),a=getDonationForms(),l=i&&a[i]||null,c="true"===t.get("auto")||!!l;if(c){if(!l){var d=Object.entries(a);d.length>0&&(l=d[0][1])}l||(c=!1)}if(c&&l){t.delete("auto"),t.delete("c"),t.delete("seva"),t.delete("form"),t.delete("opportunity");var s=t.toString()?"?"+t.toString():"";try{(window.top||window).location.href=l[currentUrlType]+s}catch(m){window.location.href=l[currentUrlType]+s}return}showBanner(r),renderTiles(currentUrlType)}else currentUrlType="ihf",renderTiles("ihf")}catch(u){}if(e(),window.requestIdleCallback?(requestIdleCallback(prefetchRemainingImages),requestIdleCallback(prefetchFormUrls)):(setTimeout(prefetchRemainingImages,200),setTimeout(prefetchFormUrls,400)),window.addEventListener("pageshow",function(t){if(t.persisted){navigating=!1,e();var n=getStoredEmployer();n&&n.trim()&&(currentUrlType=getUrlTypeForEmployer(n),showBanner(n),renderTiles(currentUrlType))}}),window!==window.top){function p(){try{window.parent.postMessage({type:"donationPageHeight",height:document.body.scrollHeight},"*")}catch(e){}}p(),setTimeout(p,500),setTimeout(p,2e3)}}();