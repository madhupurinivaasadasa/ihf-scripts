function getDonationForms(){return window.donationForms||{}}var vpfEmployerList=["Adobe","AMD","Applied Materials","Broadcom","ByteDance","Cadence","Cadence Design Systems","Cisco","Cisco Systems","Cloudera","Coupa Software","Dell","DIRECTV","DocuSign","Electronic Arts","Esurance","Etsy","Genworth","Genworth Financial","Hewlett Packard Enterprise Foundation","HPI","IBM","Intel","Intuitive Foundation","Juniper","Lam Research","LexisNexis","LinkedIn","McAfee","Microsoft","Morgan Stanley","NetApp","Oracle","Palo Alto Networks","PayPal","Pfizer","PlayStation Cares","Pure Storage","Qualcomm","Roblox","Samsung","SAP","Solidigm","Splunk","Symantec","UHG","Unum","Veeva","Veritas","VISA","Wells Fargo","Yahoo"],matchingSupportedList=["Apple","Autodesk","BlackRock","Ciena","Delta Dental","Dropbox","eBay","Equinix","F5","FalconX","Gilead","Google","Indeed","Intuit","Kaiser","Keysight","KLA","McKesson","Medtronic","Netflix","NVIDIA","Okta","Salesforce","ServiceNow","Synopsys","T-Mobile","TE Connectivity","The Illumina Foundation","Illumina","Workday"],currentUrlType="ihf",pendingForm=null,pendingQueryString="";function setEmployerCookie(e){var t=encodeURIComponent(e),n="max-age=31536000",o="path=/";document.cookie="ihf_employer_name="+t+"; "+o+"; domain=.kbmandir.org; "+n,document.cookie="ihf_employer_name="+t+"; "+o+"; domain=.kbgoshala.org; "+n,document.cookie="ihf_employer_name="+t+"; "+o+"; "+n}function getEmployerCookie(){var e=document.cookie.match(/(?:^|; )ihf_employer_name=([^;]*)/);return e?decodeURIComponent(e[1]):null}function getStoredEmployer(){return getEmployerCookie()||localStorage.getItem("ihf_employer_name")||""}function isVpfMatch(e){if(!e)return!1;var t=e.toLowerCase();return vpfEmployerList.some(function(e){return t.includes(e.toLowerCase())})}function isMatchingSupported(e){if(!e)return!1;var t=e.toLowerCase();return matchingSupportedList.some(function(e){return t.includes(e.toLowerCase())})}function getMatchTier(e){return e&&e.trim()?isVpfMatch(e)?"vpf":isMatchingSupported(e)?"matching":"none":"none"}function getUrlTypeForEmployer(e){return"vpf"===getMatchTier(e)?"vpf":"ihf"}function showBanner(e){var t=document.getElementById("employerBanner"),n=document.getElementById("bannerEmployerName"),o=document.getElementById("matchingBadge");n.textContent=e;var r=getMatchTier(e);"vpf"===r?(o.textContent="Matching eligible",o.className="matching-badge vpf"):"matching"===r?(o.textContent="Employer supports matching",o.className="matching-badge matching-supported"):(o.textContent="",o.className="matching-badge no-match"),t.classList.add("visible")}function hideBanner(){document.getElementById("employerBanner").classList.remove("visible")}var focusTrapHandler=null;function showEmployerModal(e,t){pendingForm=e||null,pendingQueryString=t||"";var n=document.getElementById("modalSevaContext");e&&e.label?(document.getElementById("modalSevaIcon").textContent=e.icon||"üôè",document.getElementById("modalSevaLabel").textContent="Donating to: "+e.label,n.classList.add("visible")):n.classList.remove("visible"),document.getElementById("modalBackdrop").classList.add("visible"),document.getElementById("employerModal").classList.add("visible");var o=document.getElementById("modalEmployerInput");o.value=getStoredEmployer(),setTimeout(function(){o.focus()},100),enableFocusTrap()}function hideEmployerModal(){document.getElementById("modalBackdrop").classList.remove("visible"),document.getElementById("employerModal").classList.remove("visible"),document.getElementById("modalSevaContext").classList.remove("visible"),pendingForm=null,pendingQueryString="",disableFocusTrap()}function enableFocusTrap(){var e=document.getElementById("employerModal"),t=e.querySelectorAll('input, button, a[onclick], [tabindex]:not([tabindex="-1"])');if(0!==t.length){var n=t[0],o=t[t.length-1];focusTrapHandler=function(e){"Tab"===e.key&&(e.shiftKey?document.activeElement===n&&(e.preventDefault(),o.focus()):document.activeElement===o&&(e.preventDefault(),n.focus()))},e.addEventListener("keydown",focusTrapHandler)}}function disableFocusTrap(){focusTrapHandler&&(document.getElementById("employerModal").removeEventListener("keydown",focusTrapHandler),focusTrapHandler=null)}function handleEmployerSubmit(){var e=document.getElementById("modalEmployerInput"),t=e.value.trim();t?(setEmployerCookie(t),localStorage.setItem("ihf_employer_name",t),currentUrlType=getUrlTypeForEmployer(t),pendingForm?(window.top||window).location.href=pendingForm[currentUrlType]+pendingQueryString:(showBanner(t),hideEmployerModal(),renderTiles(currentUrlType))):e.focus()}function handleEmployerSkip(){setEmployerCookie("NA"),localStorage.setItem("ihf_employer_name","NA"),currentUrlType="ihf",pendingForm?(window.top||window).location.href=pendingForm.ihf+pendingQueryString:(showBanner("NA"),hideEmployerModal(),renderTiles("ihf"))}function buildCard(e,t,n,o){var r=document.createElement("a");r.href=e[t]+n,r.target="_top",r.className="tile",r.addEventListener("click",function(t){var o=getStoredEmployer();o&&o.trim()?r.href=e[currentUrlType]+n:(t.preventDefault(),showEmployerModal(e,n))});var a=document.createElement("div");a.className="tile-image-wrap";var i=document.createElement("div");i.className="image-placeholder",i.style.backgroundColor=e.bgColor||"#e0e0e0",i.innerHTML='<div class="placeholder-content"><div class="placeholder-icon">'+(e.icon||"üôè")+'</div><div class="placeholder-text">'+e.label+"</div></div>";var l,d,c=document.createElement("img");c.src=e.img,c.alt=e.label,c.loading=o?"eager":"lazy",c.decoding="async",c.sizes=o?"(max-width: 720px) 100vw, 720px":"(max-width: 560px) 100vw, (max-width: 900px) 50vw, 33vw",o&&(c.fetchPriority="high"),c.style.opacity="0",d=i,(l=c).onload=function(){l.style.opacity="1",d.style.opacity="0",setTimeout(function(){d.remove()},300)},l.onerror=function(){d.classList.add("error")};var m=document.createElement("div");m.className="gradient-overlay";var s=document.createElement("div");if(s.className="tile-title-overlay",s.innerHTML='<span class="tile-title-text">'+e.label+"</span>",e.price){var p=document.createElement("span");p.className="tile-price-badge",p.textContent=e.price,a.appendChild(p)}a.appendChild(i),a.appendChild(c),a.appendChild(m),a.appendChild(s);var u=document.createElement("div");u.className="tile-body";var g=document.createElement("p");g.className="tile-tagline",g.textContent=e.tagline||"";var f=document.createElement("p");f.className="tile-description",f.textContent=e.description||"";var y=document.createElement("span");return y.className="tile-cta",y.textContent="Donate now",u.appendChild(g),u.appendChild(f),u.appendChild(y),r.appendChild(a),r.appendChild(u),r}function renderTiles(e){var t=document.getElementById("heroTile"),n=document.getElementById("donationTiles");t&&(t.innerHTML=""),n&&(n.innerHTML="");var o=new URLSearchParams(window.location.search),r=o.get("opportunity")||o.get("form");o.delete("form"),o.delete("opportunity");var a=o.toString()?"?"+o.toString():"",i=Object.entries(getDonationForms());if(r){var l=i.slice();i.sort(function(e,t){return e[0]===r?-1:t[0]===r?1:l.findIndex(function(t){return t[0]===e[0]})-l.findIndex(function(e){return e[0]===t[0]})})}i.length>0&&t&&t.appendChild(buildCard(i[0][1],e,a,!0));for(var d=t?1:0;d<i.length;d++)n.appendChild(buildCard(i[d][1],e,a,!1))}document.getElementById("modalBackdrop").addEventListener("click",function(){pendingForm?handleEmployerSkip():hideEmployerModal()});var prefetchedImages={};function prefetchHeroImage(){var e=Object.entries(getDonationForms());if(0!==e.length){var t=e[0][1];if(!prefetchedImages[t.img]){var n=new Image;n.src=t.img,n.fetchPriority="high",prefetchedImages[t.img]=!0}}}function prefetchRemainingImages(){for(var e=Object.entries(getDonationForms()),t=1;t<e.length;t++){var n=e[t][1];if(!prefetchedImages[n.img])(new Image).src=n.img,prefetchedImages[n.img]=!0}}function prefetchFormUrls(){for(var e=Object.entries(getDonationForms()),t=0;t<e.length;t++){var n=e[t][1];["vpf","ihf"].forEach(function(e){var t=document.createElement("link");t.rel="prefetch",t.href=n[e],document.head.appendChild(t)})}}document.getElementById("modalEmployerInput").addEventListener("keydown",function(e){"Enter"===e.key&&handleEmployerSubmit(),"Escape"===e.key&&hideEmployerModal()}),document.addEventListener("keydown",function(e){"Escape"===e.key&&document.getElementById("employerModal").classList.contains("visible")&&hideEmployerModal()}),function(){var e=vpfEmployerList.concat(matchingSupportedList).filter(function(e,t,n){return n.indexOf(e)===t}),t=e.filter(function(t){var n=t.toLowerCase();return!e.some(function(e){var t=e.toLowerCase();return t!==n&&t.length<n.length&&-1!==n.indexOf(t)})});t.sort(function(e,t){return e.localeCompare(t)});var n=window.matchMedia("(max-width: 768px)").matches,o=document.getElementById("modalEmployerInput");n?o.removeAttribute("list"):o.addEventListener("input",function(){var e=document.getElementById("employerSuggestions");e.innerHTML="";var n=this.value.trim();if(!(n.length<2)){var o=n.toLowerCase();t.some(function(e){return e.toLowerCase()===o})||t.forEach(function(t){if(-1!==t.toLowerCase().indexOf(o)){var n=document.createElement("option");n.value=t,e.appendChild(n)}})}}),prefetchHeroImage();var r=getStoredEmployer();if(r&&r.trim()){currentUrlType=getUrlTypeForEmployer(r);var a=new URLSearchParams(window.location.search),i=a.get("seva")||a.get("opportunity")||a.get("form"),l=getDonationForms(),d=i&&l[i]||null;if("true"===a.get("auto")||!!d){if(!d){var c=Object.entries(l);c.length>0&&(d=c[0][1])}if(d){a.delete("auto"),a.delete("seva"),a.delete("form"),a.delete("opportunity");var m=a.toString()?"?"+a.toString():"";return void((window.top||window).location.href=d[currentUrlType]+m)}}showBanner(r),renderTiles(currentUrlType)}else currentUrlType="ihf",renderTiles("ihf");window.requestIdleCallback?(requestIdleCallback(prefetchRemainingImages),requestIdleCallback(prefetchFormUrls)):(setTimeout(prefetchRemainingImages,200),setTimeout(prefetchFormUrls,400)),window.addEventListener("pageshow",function(e){if(e.persisted){hideEmployerModal();var t=getStoredEmployer();t&&t.trim()&&(currentUrlType=getUrlTypeForEmployer(t),showBanner(t),renderTiles(currentUrlType))}})}();